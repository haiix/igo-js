!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.igo=e():t.igo=e()}(window,(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e,r,n,i,a,o){try{var s=t[a](o),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,i)}r.r(e);var a={},o=!1,s=!1;function u(t,e){return c.apply(this,arguments)}function c(){var t;return t=regeneratorRuntime.mark((function t(e,r){var n,i,u,c,f=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=f.length>2&&void 0!==f[2]&&f[2],!o){t.next=3;break}throw new Error("Already fetched");case 3:return o=!0,t.next=6,Promise.all(r.map((function(t){return fetch(e+t)})));case 6:i=t.sent,u=0;case 8:if(!(u<r.length)){t.next=16;break}return t.next=11,i[u].arrayBuffer();case 11:c=t.sent,a[r[u]]=c;case 13:u++,t.next=8;break;case 16:s=n;case 17:case"end":return t.stop()}}),t)})),(c=function(){var e=this,r=arguments;return new Promise((function(n,a){var o=t.apply(e,r);function s(t){i(o,n,a,s,u,"next",t)}function u(t){i(o,n,a,s,u,"throw",t)}s(void 0)}))}).apply(this,arguments)}var f=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.fileData=a[e],this.cur=0}var e,r,i;return e=t,i=[{key:"getIntArray",value:function(e){var r=new t(e);try{return r.getIntArray(r.size()/4)}finally{r.close()}}},{key:"getString",value:function(e){var r=new t(e);try{return r.getCharArray(r.size()/2)}finally{r.close()}}}],(r=[{key:"read",value:function(t){var e=new DataView(this.fileData,this.cur,t);return this.cur+=t,e}},{key:"getInt",value:function(){return this.read(4).getInt32(0,s)}},{key:"getIntArray",value:function(t){var e=this.read(4*t);function r(t){return e.getInt32(4*t,s)}return r.size=t,r}},{key:"getShortArray",value:function(t){var e=this.read(2*t);function r(t){return e.getInt16(2*t,s)}return r.size=t,r}},{key:"getCharArray",value:function(t){var e=this.read(2*t);function r(t){return e.getUint16(2*t,s)}return r.size=t,r}},{key:"size",value:function(){return this.fileData.byteLength}},{key:"close",value:function(){}}])&&n(e.prototype,r),i&&n(e,i),t}();function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var h=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var r=new f(e+"/matrix.bin");try{this.leftSize=r.getInt(),this.rightSize=r.getInt(),this.matrix=r.getShortArray(this.leftSize*this.rightSize)}finally{r.close()}}var e,r,n;return e=t,(r=[{key:"linkCost",value:function(t,e){return this.matrix(e*this.leftSize+t)}}])&&l(e.prototype,r),n&&l(e,n),t}();function y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var v=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.s=e,this.cur=r}var e,r,n;return e=t,(r=[{key:"startsWith",value:function(t,e,r){if(this.s.length-this.cur<r)return!1;for(var n=0;n<r;n++)if(this.s[this.cur+n]!==t(e+n))return!1;return!0}},{key:"read",value:function(){return this.eos()?0:this.s[this.cur++]}},{key:"eos",value:function(){return this.cur===this.s.length}}])&&y(e.prototype,r),n&&y(e,n),t}();function d(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var g=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var r=new f(e),n=r.getInt(),i=r.getInt(),a=r.getInt();this.begs=r.getIntArray(i),this.base=r.getIntArray(n),this.lens=r.getShortArray(i),this.chck=r.getCharArray(n),this.tail=r.getCharArray(a),r.close()}var e,r,n;return e=t,(r=[{key:"eachCommonPrefix",value:function(t,e,r){for(var n=this.base(0),i=0,a=new v(t,e),o=a.read();;o=a.read(),i++){var s=n;if(0===this.chck(s)&&(r.call(e,i,p(this.base(s))),0===o))return;var u=n+o;if(n=this.base(u),this.chck(u)===o){if(n>=0)continue;this.call_if_keyIncluding(a,n,e,i,r)}return}}},{key:"call_if_keyIncluding",value:function(t,e,r,n,i){var a=p(e);t.startsWith(this.tail,this.begs(a),this.lens(a))&&i.call(r,n+this.lens(a)+1,a)}}])&&d(e.prototype,r),n&&d(e,n),t}();function p(t){return-1*t-1}function w(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var b=function(){function t(e,r,n,i,a,o,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.prev=null,this.wordId=e,this.leftId=a,this.rightId=o,this.length=n,this.cost=i,this.isSpace=s,this.start=r}var e,r,n;return e=t,n=[{key:"makeBOSEOS",value:function(){return new t(0,0,0,0,0,0,!1)}}],(r=null)&&w(e.prototype,r),n&&w(e,n),t}();function m(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function k(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function I(t,e,r){return e&&k(t.prototype,e),r&&k(t,r),t}var A=function(){function t(e){m(this,t),this.trie=new g(e+"/word2id"),this.data=f.getString(e+"/word.dat"),this.indices=f.getIntArray(e+"/word.ary.idx");var r=new f(e+"/word.inf"),n=r.size()/10;try{this.dataOffsets=r.getIntArray(n),this.leftIds=r.getShortArray(n),this.rightIds=r.getShortArray(n),this.costs=r.getShortArray(n)}finally{r.close()}}return I(t,[{key:"search",value:function(t,e,r){this.trie.eachCommonPrefix(t,e,new C(this,r))}},{key:"searchFromTrieId",value:function(t,e,r,n,i){for(var a=this.indices(t+1),o=this.indices(t);o<a;o++)i.call(new b(o,e,r,this.costs(o),this.leftIds(o),this.rightIds(o),n))}},{key:"wordData",value:function(t){for(var e=this.dataOffsets(t),r=this.dataOffsets(t+1),n=new Uint16Array(r-e),i=0;i<n.length;i++)n[i]=this.data(e+i);return n}}]),t}(),C=function(){function t(e,r){m(this,t),this.wordDic=e,this.fn=r}return I(t,[{key:"call",value:function(t,e,r){for(var n=this.wordDic.indices(r+1),i=this.wordDic.indices(r);i<n;i++)this.fn.call(new b(i,t,e,this.wordDic.costs(i),this.wordDic.leftIds(i),this.wordDic.rightIds(i),!1))}}]),t}();function S(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function x(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var O=function(){function t(e){S(this,t),this.categories=this.readCategorys(e);var r=new f(e+"/code2category");try{this.char2id=r.getIntArray(r.size()/4/2),this.eqlMasks=r.getIntArray(r.size()/4/2)}finally{r.close()}}var e,r,n;return e=t,(r=[{key:"category",value:function(t){return this.categories[this.char2id(t)]}},{key:"isCompatible",value:function(t,e){return 0!=(this.eqlMasks(t)&this.eqlMasks(e))}},{key:"readCategorys",value:function(t){for(var e=f.getIntArray(t+"/char.category"),r=e.size/4,n=[],i=0;i<r;i++)n[i]=new j(e(4*i),e(4*i+1),1===e(4*i+2),1===e(4*i+3));return n}}])&&x(e.prototype,r),n&&x(e,n),t}(),j=function t(e,r,n,i){S(this,t),this.id=e,this.length=r,this.invoke=n,this.group=i};function P(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var E=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.category=new O(e),this.spaceId=this.category.category(32).id}var e,r,n;return e=t,(r=[{key:"search",value:function(t,e,r,n){var i=t[e],a=this.category.category(i);if(!1!==n.isEmpty()||!1!==a.invoke){for(var o=a.id===this.spaceId,s=Math.min(t.length,a.length+e),u=e;u<s;u++)if(r.searchFromTrieId(a.id,e,u-e+1,o,n),u+1!==s&&!1===this.category.isCompatible(i,t[u+1]))return;if(a.group&&u<t.length){for(s=t.length;u<s;u++)if(!1===this.category.isCompatible(i,t[u]))return void r.searchFromTrieId(a.id,e,u-e,o,n);r.searchFromTrieId(a.id,e,t.length-e,o,n)}}}}])&&P(e.prototype,r),n&&P(e,n),t}();var T=function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.surface=e,this.feature=r,this.start=n};function z(t){return function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function D(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function M(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _(t,e,r){return e&&M(t.prototype,e),r&&M(t,r),t}var B=[];B.push(b.makeBOSEOS());var F=function(){function t(e){D(this,t),this.wdc=new A(e),this.unk=new E(e),this.mtx=new h(e)}return _(t,[{key:"parse",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=this.parseImpl(t);null!=r;r=r.prev){var n=t.slice(r.start,r.start+r.length),i=this.wdc.wordData(r.wordId);e.push(new T(n,i,r.start))}return e}},{key:"wakati",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=this.parseImpl(t);null!=r;r=r.prev)e.push(t.slice(r.start,r.start+r.length));return e}},{key:"parseImpl",value:function(t){var e=t.length,r=new Array(e+1);r[0]=B;for(var n=new R(this,r),i=0;i<e;i++)null!=r[i]&&(n.set(i),this.wdc.search(t,i,n),this.unk.search(t,i,this.wdc,n),delete r[i]);for(var a=this.setMincostNode(b.makeBOSEOS(),r[e]).prev,o=null;null!==a.prev;){var s=a.prev;a.prev=o,o=a,a=s}return o}},{key:"setMincostNode",value:function(t,e){for(var r=t.prev=e[0],n=r.cost+this.mtx.linkCost(r.rightId,t.leftId),i=1;i<e.length;i++){var a=e[i],o=a.cost+this.mtx.linkCost(a.rightId,t.leftId);o<n&&(n=o,t.prev=a)}return t.cost+=n,t}}]),t}(),R=function(){function t(e,r){D(this,t),this.empty=!0,this.tagger=e,this.nodesAry=r}return _(t,[{key:"set",value:function(t){this.i=t,this.prevs=this.nodesAry[t],this.empty=!0}},{key:"call",value:function(t){this.empty=!1;var e,r=this.i+t.length;(null==this.nodesAry[r]&&(this.nodesAry[r]=[]),t.isSpace)?(e=this.nodesAry[r]).push.apply(e,z(this.prevs)):this.nodesAry[r].push(this.tagger.setMincostNode(t,this.prevs))}},{key:"isEmpty",value:function(){return this.empty}}]),t}();function U(t,e,r,n,i,a,o){try{var s=t[a](o),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,i)}function q(t){return N.apply(this,arguments)}function N(){var t;return t=regeneratorRuntime.mark((function t(e){var r,n=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.length>1&&void 0!==n[1]&&n[1],t.next=3,u(e,["/word2id","/word.dat","/word.ary.idx","/word.inf","/char.category","/code2category","/matrix.bin"],r);case 3:case"end":return t.stop()}}),t)})),(N=function(){var e=this,r=arguments;return new Promise((function(n,i){var a=t.apply(e,r);function o(t){U(a,n,i,o,s,"next",t)}function s(t){U(a,n,i,o,s,"throw",t)}o(void 0)}))}).apply(this,arguments)}function W(t){for(var e=new Uint16Array(t.length),r=0;r<t.length;r++)e[r]=t.charCodeAt(r);var n=new F("").parse(e),i=!0,a=!1,o=void 0;try{for(var s,u=n[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;c.surface=c.surface.reduce((function(t,e){return t+String.fromCharCode(e)}),""),c.feature=c.feature.reduce((function(t,e){return t+String.fromCharCode(e)}),"")}}catch(t){a=!0,o=t}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}return n}function L(t){for(var e=new Uint16Array(t.length),r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return new F("").wakati(e).map((function(t){return t.reduce((function(t,e){return t+String.fromCharCode(e)}),"")}))}r.d(e,"fetchDic",(function(){return q})),r.d(e,"parse",(function(){return W})),r.d(e,"wakati",(function(){return L}))}])}));